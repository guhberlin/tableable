/*
 *  jQuery tableable plugin - v3.0.0
 *  A plugin to filter, paginate and sort html tables and any blockelement that should act as a table.
 *  http://guhberlin.github.io/tableable
 *
 *  Made by guhberlin
 *  Under BSD-3-Clause License
 */
!function(a,b,c,d){"use strict";function e(){}function f(b,c,d,e){this.element=b,this.settings=c,this.constants=d,this.afterFilter=e;var f=this;a(this.settings.filterInputSelector).keyup(function(){f.filter()}),f.filter()}function g(b,c,d,f){this.element=b,this.settings=c,this.constants=d,this.afterSort=f;var g=this;a(g.element).children(g.constants.get("selector","thead")).children(g.constants.get("selector","tr")).children(g.constants.get("selector","th")).each(function(){if(!g.settings.notSortableAttribute.length||!e.Element(this).hasAttr(g.settings.notSortableAttribute)){var b=a(this).index()+1,c=g.settings.sortTriggerSelector.length?a(this).find(g.settings.sortTriggerSelector):a(this);c.on("click",function(){g.sortRows(b),g.afterSort()})}});var h=a(g.element).find(g.constants.get("selector","thead")+" "+g.constants.get("selector","tr")+" "+g.constants.get("selector","th")+":nth-child("+g.settings.initalSortColIndex+")");h&&!e.Element(h).hasAttr(g.settings.notSortableAttribute)&&g.sortRows(g.settings.initalSortColIndex)}function h(a,b,c,d){this.element=a,this.settings=b,this.constants=c,this.afterPaginate=d,this.pagerListBuildFunction=this.settings.useDottedPager?"buildDottedPagerList":"buildFullPagerList",this.paginate()}function i(){}function j(b){this.element=b,this.elementType="table"===a(b).prop("tagName").toLowerCase()?"table":"block",this.initConstants()}function k(b,c){this.element=a(b),this.constants=new j(b),this.initSettings(c).initFeatures()}e.Element=function(b){var c=this.Element.prototype;return c.el=a(b),c},e.Element.prototype.hasAttr=function(b){return b!==d?a(this.el).attr(b)!==d:!1},e.Element.prototype.hasOneOfAttrs=function(a){var b=this;return a.filter(function(a){return b.hasAttr(a)}).length>0},f.prototype.filter=function(){var b=this,c=[],d=a(b.settings.filterInputSelector).val();d=b.settings.ignoreCase?d.toLowerCase():d,a(b.element).children(b.constants.get("selector","thead")).children(b.constants.get("selector","tr")).children(b.constants.get("selector","th")+"["+b.settings.notFilterAttribute+"]").each(function(){c.push(a(this).index())}),a(b.element).children(b.constants.get("selector","tbody")).children(b.constants.get("selector","tr")).css("display","none").attr(b.settings.filteredAttribute,"").each(function(){var f=a(this);f.children(b.constants.get("selector","td")).each(function(g,h){c.indexOf(a(this).index())>=0||e.Element(this).hasAttr(b.settings.notFilterAttribute)||e.Element(f).hasOneOfAttrs(b.settings.customFilteredAttributes)||(h=b.settings.ignoreCase?a(h).text().toLowerCase():a(h).text(),h.indexOf(d)>=0&&f.css("display",b.constants.get("displayType","tr")).removeAttr(b.settings.filteredAttribute))})}),b.afterFilter()},g.prototype.sortRows=function(b){var c=this,d=a(c.element).children(c.constants.get("selector","thead")).children(c.constants.get("selector","tr")).find(":nth-child("+b+")"),e="ASC"!==d.attr(c.settings.sortedAttribute)?"ASC":"DESC";c["sort"+e](b),d.parent().children(c.constants.get("selector","th")).removeAttr(c.settings.sortedAttribute),d.attr(c.settings.sortedAttribute,e)},g.prototype.sortASC=function(a){var b=this;b.sortWithCallback(function(c,d){return b.sortCallback(c,d,a)})},g.prototype.sortDESC=function(a){var b=this;b.sortWithCallback(function(c,d){return b.sortCallback(d,c,a)})},g.prototype.sortCallback=function(b,c,d){function e(b){return a(a(b).find(f.constants.get("selector","td"))[d-1]).text()}var f=this;return e(c)<e(b)?1:-1},g.prototype.sortWithCallback=function(b){var c=this;a(c.element).children(c.constants.get("selector","tbody")).append(a(c.element).children(c.constants.get("selector","tbody")).children(c.constants.get("selector","tr")).sort(b))},h.prototype.paginate=function(){var b=this,c=0;a(b.element).children(b.constants.get("selector","tbody")).children(b.constants.get("selector","tr")).removeAttr(b.settings.pageIndexAttribute).filter(function(){return!e.Element(this).hasOneOfAttrs(b.settings.customFilteredAttributes)&&!e.Element(this).hasAttr(b.settings.filteredAttribute)}).each(function(d){d%b.settings.rowsPerPage===0&&c++,a(this).attr(b.settings.pageIndexAttribute,c)}),b.showPage(b.settings.currentPageIndex)},h.prototype.getPageCount=function(){var b=this;return Math.ceil(a(b.element).children(b.constants.get("selector","tbody")).children(b.constants.get("selector","tr")).filter(function(){return!e.Element(this).hasOneOfAttrs(b.settings.customFilteredAttributes)&&!e.Element(this).hasAttr(b.settings.filteredAttribute)}).length/b.settings.rowsPerPage)},h.prototype.buildPagerList=function(){var b=this,c=parseInt(b.settings.currentPageIndex),d=b.getPageCount();a(b.settings.pagerListSelector).empty(),b.settings.firstLable.length>0&&b.appendPagerItem(b.settings.firstLable,c>1?1:b.settings.inactivPagerIndex),b.settings.prevLable.length>0&&b.appendPagerItem(b.settings.prevLable,c>1?c-1:b.settings.inactivPagerIndex),b[b.pagerListBuildFunction](),b.settings.nextLable.length>0&&b.appendPagerItem(b.settings.nextLable,d>c?c+1:b.settings.inactivPagerIndex),b.settings.lastLable.length>0&&b.appendPagerItem(b.settings.lastLable,d>c?d:b.settings.inactivPagerIndex),a(b.settings.pagerListSelector+" li["+b.settings.showPageIndexAttribute+"]").on("click",function(){b.showPage(a(this).attr(b.settings.showPageIndexAttribute))})},h.prototype.buildFullPagerList=function(){for(var a=this,b=a.getPageCount(),c=1;b>=c;c++)a.appendPagerItem(c,c)},h.prototype.buildDottedPagerList=function(){for(var a=this,b=parseInt(a.settings.currentPageIndex),c=parseInt(a.settings.noOfShownPagesStartEnd),d=parseInt(a.settings.noOfShownPagesNextToCurrentPage),e=a.getPageCount(),f=!0,g=1;e>=g;g++)c>=g||g>=b-d&&b+d>=g||g>e-c?(a.appendPagerItem(g,g),f=!0):f&&(a.appendPagerItem("..."),f=!1)},h.prototype.showPage=function(b){var c=this;b!==c.settings.inactivPagerIndex&&(a(c.element).children(c.constants.get("selector","tbody")).children(c.constants.get("selector","tr")).css("display","none").filter(c.constants.get("selector","tr")+"["+c.settings.pageIndexAttribute+'="'+b+'"]').css("display",c.constants.get("displayType","tr")),c.settings.currentPageIndex=b,c.buildPagerList(),a(c.settings.pagerListSelector+" li").removeClass("active"),a(c.settings.pagerListSelector+" li["+c.settings.showPageIndexAttribute+'="'+b+'"]').addClass("active"),c.afterPaginate())},h.prototype.appendPagerItem=function(b,c,e){var f=this,g="",h="";c!==d&&(g=f.settings.showPageIndexAttribute+'="'+c+'"'),h=a.map(e||{},function(a,b){return a+'="'+b+'"'}).join(" "),a(f.settings.pagerListSelector).append("<li  "+g+" "+h+"><a>"+b+"</a></li>")},i.prototype.getDefaults=function(){return{filter:{filterInputSelector:"",ignoreCase:!1,notFilterAttribute:"data-no-filter",customFilteredAttributes:[]},pager:{useDottedPager:!0,pagerListSelector:"",rowsPerPage:5,customFilteredAttributes:[],noOfShownPagesStartEnd:2,noOfShownPagesNextToCurrentPage:1,inactivPagerIndex:"-1",firstLable:"",prevLable:"",nextLable:"",lastLable:""},sorter:{sortTriggerSelector:"",jumpPageOneAfterSort:!0,notSortableAttribute:"data-no-sort",initalSortColIndex:-1}}},i.prototype.getUneditableDefaults=function(){return{filter:{filteredAttribute:"data-is-filtered"},pager:{pageIndexAttribute:"data-page-index",showPageIndexAttribute:"data-show-page-index",currentPageIndex:"1"},sorter:{sortedAttribute:"data-sort-by"},events:{sorted:"sorted",filtered:"filtered",updated:"updated",paged:"paged",refresh:"refresh"}}},j.prototype.get=function(a,b){var c=this;return c[a][c.elementType][b.toLowerCase()]},j.prototype.initConstants=function(){var b=this,c=a(b.element);return b.selector={table:b.getTableSelectors(),block:b.getBlockSelectors()},b.displayType={table:b.getTableDisplayTypes(c),block:b.getBlockDisplayTypes(c)},b},j.prototype.getTableSelectors=function(){return{table:"table",tbody:"tbody",thead:"thead",tfoot:"tfoot",tr:"tr",th:"th",td:"td"}},j.prototype.getTableDisplayTypes=function(a){return{table:a.css("display")||"table",tbody:a.find("tbody").first().css("display")||"table-row-group",thead:a.find("thead").first().css("display")||"table-header-group",tfoot:a.find("tfoot").first().css("display")||"table-footer-group",tr:a.find("tr").first().css("display")||"table-row",th:a.find("th").first().css("display")||"table-cell",td:a.find("td").first().css("display")||"table-cell"}},j.prototype.getBlockSelectors=function(){return{table:".ta-table",tbody:".ta-tbody",thead:".ta-thead",tfoot:".ta-tfoot",tr:".ta-tr",th:".ta-th",td:".ta-td"}},j.prototype.getBlockDisplayTypes=function(a){return{table:a.css("display")||"block",tbody:a.find(".ta-tbody").first().css("display")||"block",thead:a.find(".ta-thead").first().css("display")||"block",tfoot:a.find(".ta-tfoot").first().css("display")||"block",tr:a.find(".ta-tr").first().css("display")||"block",th:a.find(".ta-th").first().css("display")||"block",td:a.find(".ta-td").first().css("display")||"block"}},k.prototype.initSettings=function(b){var c=this,d=new i;return c.settings={},c.settings.shouldPaginate=b.pager&&b.pager.pagerListSelector.length?!0:!1,c.settings.shouldFilter=b.filter&&b.filter.filterInputSelector.length?!0:!1,c.settings.shouldSort=b.sorter&&a(c.element).find(c.constants.get("selector","thead")).length?!0:!1,c.settings=a.extend(!0,c.settings,d.getDefaults(),b,d.getUneditableDefaults()),c.settings.pager.filteredAttribute=c.settings.filter.filteredAttribute,c},k.prototype.initFeatures=function(){var b=this;return b.settings.shouldPaginate&&(b.pager=new h(b.element,b.settings.pager,b.constants,function(){b.afterPaginate()})),b.settings.shouldFilter&&(b.filter=new f(b.element,b.settings.filter,b.constants,function(){b.afterFilter()})),b.settings.shouldSort&&(b.sorter=new g(b.element,b.settings.sorter,b.constants,function(){b.afterSort()})),a(b.element).on(b.settings.events.refresh,function(){b.settings.shouldFilter?b.filter.filter():b.settings.shouldPaginate&&b.pager.paginate()}),b},k.prototype.afterFilter=function(){var a=this;a.trigger(a.settings.events.filtered,!1),a.settings.shouldPaginate?(a.settings.pager.currentPageIndex="1",a.pager.paginate()):a.trigger(a.settings.events.updated)},k.prototype.afterSort=function(){var a=this;a.trigger(a.settings.events.sorted,!1),a.settings.shouldPaginate?(a.settings.jumpPageOneAfterSort&&(a.settings.pager.currentPageIndex="1"),a.pager.paginate()):a.trigger(a.settings.events.updated)},k.prototype.afterPaginate=function(){var a=this;a.trigger(a.settings.events.paged)},k.prototype.trigger=function(b,c){var e=this,f=c===d?!0:c;a(e.element).trigger(b),f&&b!==e.settings.events.updated&&a(e.element).trigger(e.settings.events.updated)},a.fn.tableable=function(b){return this.each(function(){a.data(this,"plugin_tableable")||a.data(this,"plugin_tableable",new k(this,b))}),this}}(jQuery,window,document);